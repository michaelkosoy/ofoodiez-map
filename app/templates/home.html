<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ofoodiez - Best Happy Hours & Food Guides</title>
    <meta name="description" content="{{ data.slogan }}">

    <!-- PWA & Icons -->
    <link rel="icon" href="{{ url_for('static', filename='img/logo.png') }}">
    <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='img/icon-192.png') }}">
    <meta name="theme-color" content="#FF6B6B">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">

    <!-- Styles -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/home.css') }}?v=3">
</head>

<body>
    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-overlay">
            <h1 class="hero-title">Ofoodiez</h1>
            <p class="hero-subtitle">{{ data.slogan }}</p>
        </div>
    </section>

    <div class="container">
        <!-- Community Insider Section -->
        <section class="section">
            <div class="community-card">
                <h3>{{ data.community.title }}</h3>
                <p>{{ data.community.description }}</p>
                <a href="{{ data.community.link }}" target="_blank" class="btn-white">
                    <i class="fab fa-whatsapp"></i> {{ data.community.link_text }}
                </a>
            </div>
        </section>

        <!-- World Food Maps Section -->
        <section class="section" id="destinations">
            <h3 class="section-title">World Food Maps</h3>
            <div class="world-grid">
                {% for item in data.world_maps %}
                <a href="{{ item.map_link }}" class="country-card"
                    style="background-image: url('{{ url_for('static', filename='img/' + item.country.lower() + '.png') }}');"
                    {% if 'http' in item.map_link %}target="_blank" {% endif %}>
                    <div class="country-overlay">
                        <span class="country-name">{{ item.country }}</span>
                        <span class="cities">{{ item.cities }}</span>
                    </div>
                </a>
                {% endfor %}
            </div>
        </section>

        <!-- Social Media Links -->
        <div class="social-media">
            {% for social in data.social_media %}
            <a href="{{ social.link }}" target="_blank" class="social-icon">
                <i class="{{ social.icon }}"></i>
            </a>
            {% endfor %}
        </div>

        <!-- Spacer for bottom nav -->
        <div class="bottom-nav-spacer"></div>
    </div>

    <!-- Sticky Bottom Navigation -->
    <nav class="bottom-nav">
        <a href="/" class="bottom-nav-item active">
            <i class="fas fa-home"></i>
            <span>Home</span>
        </a>
        <a href="/map" class="bottom-nav-item">
            <i class="fas fa-map-marked-alt"></i>
            <span>Happy Hour Map</span>
        </a>
        <a href="/about" class="bottom-nav-item">
            <i class="fas fa-user"></i>
            <span>About Me</span>
        </a>
        <a href="#" class="bottom-nav-item disabled" onclick="showComingSoon(event)">
            <i class="fas fa-building"></i>
            <span>HiTech</span>
        </a>
    </nav>

    <!-- PWA Service Worker Registration -->
    <script>
        function showComingSoon(event) {
            event.preventDefault();
            alert('HiTech section coming soon! ðŸš€');
        }

        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/static/sw.js')
                    .then(registration => {
                        console.log('ServiceWorker registration successful');
                    })
                    .catch(err => {
                        console.log('ServiceWorker registration failed: ', err);
                    });
            });
        }

        // Smooth scroll to top
        function scrollToTop(event) {
            event.preventDefault();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Active state for bottom nav
        document.addEventListener('DOMContentLoaded', function () {
            const bottomNavItems = document.querySelectorAll('.bottom-nav-item');
            const sections = document.querySelectorAll('section[id]');

            // Handle hash navigation for bottom nav
            bottomNavItems.forEach(item => {
                item.addEventListener('click', function (e) {
                    if (this.getAttribute('href').startsWith('#')) {
                        e.preventDefault();
                        const targetId = this.getAttribute('href');

                        // Remove active from all
                        bottomNavItems.forEach(nav => nav.classList.remove('active'));

                        // Add active to clicked
                        this.classList.add('active');

                        // Scroll to section
                        if (targetId !== '#') {
                            const targetSection = document.querySelector(targetId);
                            if (targetSection) {
                                targetSection.scrollIntoView({ behavior: 'smooth' });
                            }
                        }
                    }
                });
            });

            // Update active state on scroll
            window.addEventListener('scroll', () => {
                let current = '';
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    const sectionHeight = section.clientHeight;
                    if (window.pageYOffset >= sectionTop - 200) {
                        current = section.getAttribute('id');
                    }
                });

                // If near top, set home as active
                if (window.pageYOffset < 300) {
                    bottomNavItems.forEach(item => {
                        item.classList.remove('active');
                        if (item.getAttribute('href') === '#') {
                            item.classList.add('active');
                        }
                    });
                } else if (current) {
                    bottomNavItems.forEach(item => {
                        item.classList.remove('active');
                        if (item.getAttribute('href') === '#' + current) {
                            item.classList.add('active');
                        }
                    });
                }
            });
        });
    </script>
</body>

</html>